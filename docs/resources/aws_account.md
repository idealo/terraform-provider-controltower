---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "controltower_aws_account Resource - terraform-provider-controltower"
subcategory: ""
description: |-
  Provides an AWS account resource via Control Tower.
---

# controltower_aws_account (Resource)

Provides an AWS account resource via Control Tower.

## Example Usage

```terraform
# Basic Example
resource "controltower_aws_account" "basic_account_example" {
  name                = "Example Account"
  email               = "aws-admin@example.com"
  organizational_unit = "Sandbox"

  organizational_unit_id_on_delete = "ou-some-id"

  sso {
    first_name = "John"
    last_name  = "Doe"
    email      = "john.doe@example.com"
  }
}
##########################################################################################################

# Extended Example to handle account reassignment upon update
locals {
  username = "john.doe@example.de"
}

data "aws_ssoadmin_instances" "sso" {}

# Normally AWSAdministratorAccess is the default permission set assigned to the account upon creation by Control Tower.
data "aws_ssoadmin_permission_set" "permission" {

  instance_arn = tolist(data.aws_ssoadmin_instances.sso.arns)[0]
  name         = "AWSAdministratorAccess"
}

data "aws_identitystore_user" "user" {

  identity_store_id = tolist(data.aws_ssoadmin_instances.sso.identity_store_ids)[0]
  alternate_identifier {
    unique_attribute {
      attribute_path  = "UserName"
      attribute_value = local.username
    }
  }
}

resource "controltower_aws_account" "extended_example_account" {
  name                = "Extended Example Account"
  email               = local.username
  organizational_unit = "Sandbox"

  organizational_unit_id_on_delete = "ou-some-id"

  sso {
    first_name                          = "John"
    last_name                           = "Doe"
    email                               = "aws-admin@example.com"
    instance_arn                        = tolist(data.aws_ssoadmin_instances.sso.arns)[0]
    principal_id                        = data.aws_identitystore_user.user.user_id
    remove_account_assignment_on_update = true
    permission_set_arn                  = data.aws_ssoadmin_permission_set.permission.arn

  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `email` (String) Root email of the account.
- `name` (String) Name of the account.
- `organizational_unit` (String) Name of the Organizational Unit under which the account resides.
- `sso` (Block List, Min: 1, Max: 1) Assigned SSO user settings. (see [below for nested schema](#nestedblock--sso))

### Optional

- `close_account_on_delete` (Boolean) If enabled, this will close the AWS account on resource deletion, beginning the 90-day suspension period. Otherwise, the account will just be unenrolled from Control Tower.
- `organizational_unit_id_on_delete` (String) ID of the Organizational Unit to which the account should be moved when the resource is deleted. If no value is provided, the account will not be moved.
- `path_id` (String) Name of the path identifier of the product. This value is optional if the product has a default path, and required if the product has more than one path. To list the paths for a product, use ListLaunchPaths.
- `provisioned_product_name` (String) Name of the service catalog product that is provisioned. Defaults to a slugified version of the account name.
- `tags` (Map of String) Key-value map of resource tags for the account.

### Read-Only

- `account_id` (String) ID of the AWS account.
- `id` (String) The ID of this resource.

<a id="nestedblock--sso"></a>
### Nested Schema for `sso`

Required:

- `email` (String) Email address of the user. If you use automatic provisioning this email address should already exist in AWS SSO.
- `first_name` (String) First name of the user.
- `last_name` (String) Last name of the user.

Optional:

- `instance_arn` (String) ARN of the SSO instance. Required if remove_account_assignment_on_update is enabled.
- `permission_set_arn` (String) ARN of the permission set to be removed, normally it's the arn of AWSAdministratorAccess permission set. Required if remove_account_assignment_on_update is enabled.
- `principal_id` (String) Principal ID of the user. Required if remove_account_assignment_on_update is enabled.
- `remove_account_assignment_on_update` (Boolean) If enabled, this will remove the account assignment for the old SSO user when the resource is updated.
